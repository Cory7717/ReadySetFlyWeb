import{x as d,r,y as p,z as y,A as P,D as g}from"./index-umuuNHW5.js";const l="rsf.studentProfile";function u(){if(typeof window>"u")return{};try{const e=localStorage.getItem(l);return e?JSON.parse(e):{}}catch{return{}}}function m(e){if(!(typeof window>"u"))try{localStorage.setItem(l,JSON.stringify(e))}catch{}}function S(){const{user:e}=d(),[o,s]=r.useState(()=>u()),{data:a,isLoading:f}=p({queryKey:["/api/student/profile"],enabled:!!e});r.useEffect(()=>{e||s(u())},[e==null?void 0:e.id]);const c=r.useMemo(()=>e?a||{}:o,[e,a,o]),i=y({mutationFn:async t=>{const n={wizardJson:t.wizardJson??null,roadmapJson:t.roadmapJson??null,progressJson:t.progressJson??null};return(await g("PUT","/api/student/profile",n)).json()},onSuccess:()=>{P.invalidateQueries({queryKey:["/api/student/profile"]})}});return{profile:c,saveProfile:t=>{if(e)return i.mutate(t);const n={...o,...t};s(n),m(n)},isLoading:e?f:!1,saving:i.isPending}}export{S as u};
